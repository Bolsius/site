<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uitleg van VBA-code: Gerechten Exporteren Naar TXT</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            display: flex;
            justify-content: center;
        }
        .container {
            max-width: 800px;
            width: 100%;
        }
        h1 {
            color: #2c3e50;
        }
        p {
            margin-bottom: 20px;
        }
        pre {
            background-color: #f4f4f4;
            border: 1px solid #ddd;
            padding: 10px;
            overflow-x: auto;
            line-height: 1.4;
            border-radius: 5px;
            font-size: 11px; /* Kleinere lettergrootte voor de code */
        }
        code {
            font-family: Consolas, "Courier New", monospace;
        }
        /* Specifieke kleuren voor VBA-code */
        .comment {
            color: #008000; /* Groen voor commentaar */
        }
        .keyword {
            color: #0000FF; /* Blauw voor sleutelwoorden */
        }
        .string {
            color: #A31515; /* Rood voor strings */
        }
        .number {
            color: #098658; /* Donkergroen voor getallen */
        }
    </style>
</head>
<body>

<div class="container">
    <h1>VBA-code: Gerechten Exporteren Naar TXT</h1>

    <p>Deze VBA-code exporteert gegevens van een Excel-werkblad naar een tekstbestand. De code verzamelt bepaalde waarden uit cellen en schrijft deze naar een bestand in de Downloads-map. Hier zijn de hoofdfuncties van de code:</p>

    <ul>
        <li>Het leest de waarde van cel <code>B19</code>, die wordt gebruikt om de naam van het exportbestand aan te passen.</li>
        <li>Het creÃ«ert een tekstbestand in de Downloads-map met de naam "Menu Bergerat {Waarde van B19}".</li>
        <li>De code bevat een sjabloon voor het verbeteren van gerechten en vult bepaalde celwaarden automatisch in in het tekstbestand.</li>
        <li>Het bestand wordt opgeslagen, en een bericht wordt weergegeven zodra het proces is voltooid.</li>
    </ul>

    <h2>De VBA-code</h2>

    <pre><code>
<span class="keyword">Sub</span> GerechtenExporterenNaarTXT()
    <span class="keyword">Dim</span> ws <span class="keyword">As</span> Worksheet
    <span class="keyword">Set</span> ws = ThisWorkbook.Sheets(1) <span class="comment">' Pas aan naar het juiste werkblad</span>
    
    <span class="comment">' Haal de waarde van cel B19 op</span>
    <span class="keyword">Dim</span> menuName <span class="keyword">As</span> <span class="keyword">String</span>
    menuName = ws.Range(<span class="string">"B19"</span>).Value
    
    <span class="comment">' Definieer het pad naar de Downloads-map en de bestandsnaam (Menu Bergerat met waarde van B19)</span>
    <span class="keyword">Dim</span> downloadPath <span class="keyword">As</span> <span class="keyword">String</span>
    downloadPath = Environ(<span class="string">"USERPROFILE"</span>) & <span class="string">"\Downloads\Menu Bergerat "</span> & menuName & <span class="string">".txt"</span>
    
    <span class="comment">' Open het tekstbestand om te schrijven (overschrijven indien het al bestaat)</span>
    <span class="keyword">Dim</span> txtFile <span class="keyword">As</span> <span class="keyword">Integer</span>
    txtFile = FreeFile
    <span class="keyword">Open</span> downloadPath <span class="keyword">For Output As</span> txtFile
    
    <span class="comment">'Instructies</span>
    Print #txtFile, <span class="string">"Kan je deze verbeteren op schrijffouten fouten? en opnieuw de code maken?"</span>
    
    <span class="comment">' Schrijf de VBA-stijl structuur naar het tekstbestand</span>
    Print #txtFile, <span class="string">"Sub GerechtenVerbeteren()"</span>
    Print #txtFile, <span class="string">"    Dim ws As Worksheet"</span>
    Print #txtFile, <span class="string">"    Set ws = ThisWorkbook.Sheets(1) ' Pas aan naar het juiste werkblad"</span>
    Print #txtFile, <span class="string">""</span>
    Print #txtFile, <span class="string">"    ' Verbeteren van de gerechten (cel per cel)"</span>
    Print #txtFile, <span class="string">""</span>
    
    <span class="comment">' Chef's Soup Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"    ' Chef's Soup (Maandag t/m Vrijdag) in kolommen D, G, J, M, P"</span>
    Print #txtFile, <span class="string">"    ws.Range(""D21"").Value = """ & ws.Range(<span class="string">"D21"</span>).Value & <span class="string">"""</span></span>
    Print #txtFile, <span class="string">"    ws.Range(""D23"").Value = """ & ws.Range(<span class="string">"D23"</span>).Value & <span class="string">"""</span></span>
    <span class="comment">' enzovoort...</span>
    
    <span class="keyword">Close</span> txtFile
    
    <span class="comment">' Bericht om aan te geven dat het bestand is opgeslagen</span>
    MsgBox <span class="string">"De gerechten zijn opgeslagen in de Downloads-map als Menu Bergerat "</span> & menuName & <span class="string">".txt!"</span>
<span class="keyword">End Sub</span>
    </code></pre>
</div>

</body>
</html>
