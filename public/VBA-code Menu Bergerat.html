<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uitleg van VBA-code: Gerechten Exporteren Naar TXT</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            display: flex;
            justify-content: center;
        }
        .container {
            max-width: 800px;
            width: 100%;
        }
        h1 {
            color: #2c3e50;
        }
        p {
            margin-bottom: 20px;
        }
        pre {
            background-color: #f4f4f4;
            border: 1px solid #ddd;
            padding: 10px;
            overflow-x: auto;
            line-height: 1.4;
            border-radius: 5px;
            font-size: 11px; /* Kleinere lettergrootte voor de code */
        }
        code {
            font-family: Consolas, "Courier New", monospace;
        }
        /* Specifieke kleuren voor VBA-code */
        .comment {
            color: #008000; /* Groen voor commentaar */
        }
        .keyword {
            color: #0000FF; /* Blauw voor sleutelwoorden */
        }
        .string {
            color: #A31515; /* Rood voor strings */
        }
        .number {
            color: #098658; /* Donkergroen voor getallen */
        }
    </style>
</head>
<body>

<div class="container">
    <h1>VBA-code: Gerechten Exporteren Naar TXT</h1>

    <p>Deze VBA-code exporteert gegevens van een Excel-werkblad naar een tekstbestand. De code verzamelt bepaalde waarden uit cellen en schrijft deze naar een bestand in de Downloads-map. Hier zijn de hoofdfuncties van de code:</p>

    <ul>
        <li>Het leest de waarde van cel <code>B19</code>, die wordt gebruikt om de naam van het exportbestand aan te passen.</li>
        <li>Het creÃ«ert een tekstbestand in de Downloads-map met de naam "Menu Bergerat {Waarde van B19}".</li>
        <li>De code bevat een sjabloon voor het verbeteren van gerechten en vult bepaalde celwaarden automatisch in in het tekstbestand.</li>
        <li>Het bestand wordt opgeslagen, en een bericht wordt weergegeven zodra het proces is voltooid.</li>
    </ul>

    <h2>De VBA-code</h2>

    <pre><code>
<span class="keyword">Sub</span> GerechtenExporterenNaarTXT()
    <span class="keyword">Dim</span> ws <span class="keyword">As</span> Worksheet
    <span class="keyword">Set</span> ws = ThisWorkbook.Sheets(1) <span class="comment">' Pas aan naar het juiste werkblad</span>
    
    <span class="comment">' Haal de waarde van cel B19 op</span>
    <span class="keyword">Dim</span> menuName <span class="keyword">As</span> <span class="keyword">String</span>
    menuName = ws.Range(<span class="string">"B19"</span>).Value
    
    <span class="comment">' Definieer het pad naar de Downloads-map en de bestandsnaam (Menu Bergerat met waarde van B19)</span>
    <span class="keyword">Dim</span> downloadPath <span class="keyword">As</span> <span class="keyword">String</span>
    downloadPath = Environ(<span class="string">"USERPROFILE"</span>) & <span class="string">"\Downloads\Menu Bergerat "</span> & menuName & <span class="string">".txt"</span>
    
    <span class="comment">' Open het tekstbestand om te schrijven (overschrijven indien het al bestaat)</span>
    <span class="keyword">Dim</span> txtFile <span class="keyword">As</span> <span class="keyword">Integer</span>
    txtFile = FreeFile
    <span class="keyword">Open</span> downloadPath <span class="keyword">For Output As</span> txtFile
    
    <span class="comment">' Schrijf de titel en een separator</span>
    Print #txtFile, <span class="string">"Menu Bergerat - Gerechten Export"</span>
    Print #txtFile, <span class="string">"----------------------------------------"</span>
    Print #txtFile, <span class="string">""</span>
    
    <span class="comment">' Chef's Soup Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Chef's Soup"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D21"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G21"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J21"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M21"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P21"</span>).Value
    Print #txtFile, <span class="string">""</span>

    <span class="comment">' Chef's Soup FR Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Chef's Soup FR"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D23"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G23"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J23"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M23"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P23"</span>).Value
    Print #txtFile, <span class="string">""</span>
    
    <span class="comment">' Salade A Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Salade A"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D24"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G24"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J24"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M24"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P24"</span>).Value
    Print #txtFile, <span class="string">""</span>
    
    <span class="comment">' Salade A FR Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Salade A FR"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D26"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G26"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J26"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M26"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P26"</span>).Value
    Print #txtFile, <span class="string">""</span>

    <span class="comment">' Salade B Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Salade B"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D27"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G27"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J27"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M27"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P27"</span>).Value
    Print #txtFile, <span class="string">""</span>
    
    <span class="comment">' Salade B FR Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Salade B FR"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D29"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G29"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J29"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M29"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P29"</span>).Value
    Print #txtFile, <span class="string">""</span>

    <span class="comment">' Brood Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Brood"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D30"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G30"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J30"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M30"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P30"</span>).Value
    Print #txtFile, <span class="string">""</span>
    
    <span class="comment">' Brood FR Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Brood FR"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D32"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G32"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J32"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M32"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P32"</span>).Value
    Print #txtFile, <span class="string">""</span>

    <span class="comment">' Hot Dish Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Hot Dish"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D33"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G33"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J33"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M33"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P33"</span>).Value
    Print #txtFile, <span class="string">""</span>

    <span class="comment">' Hot Dish FR Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"Hot Dish FR"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D35"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G35"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J35"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M35"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P35"</span>).Value
    Print #txtFile, <span class="string">""</span>
    
    <span class="comment">' A La Carte Hot Snack Maandag t/m Vrijdag</span>
    Print #txtFile, <span class="string">"A La Carte Hot Snack"</span>
    Print #txtFile, <span class="string">"------------------------"</span>
    Print #txtFile, <span class="string">"Maandag: "</span> & ws.Range(<span class="string">"D36"</span>).Value
    Print #txtFile, <span class="string">"Dinsdag: "</span> & ws.Range(<span class="string">"G36"</span>).Value
    Print #txtFile, <span class="string">"Woensdag: "</span> & ws.Range(<span class="string">"J36"</span>).Value
    Print #txtFile, <span class="string">"Donderdag: "</span> & ws.Range(<span class="string">"M36"</span>).Value
    Print #txtFile, <span class="string">"Vrijdag: "</span> & ws.Range(<span class="string">"P36"</span>).Value
    Print #txtFile, <span class="string">""</span>
    
    <span class="keyword">Close</span> txtFile
    
    <span class="comment">' Bericht om aan te geven dat het bestand is opgeslagen</span>
    MsgBox <span class="string">"De gerechten zijn opgeslagen in de Downloads-map als Menu Bergerat "</span> & menuName & <span class="string">".txt!"</span>
<span class="keyword">End Sub</span>

    </code></pre>
</div>

</body>
</html>
